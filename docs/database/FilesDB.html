<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_71) on Sun Jan 11 22:46:32 WET 2015 -->
<title>FilesDB</title>
<meta name="date" content="2015-01-11">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="FilesDB";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../database/RepositoriesDB.html" title="class in database"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?database/FilesDB.html" target="_top">Frames</a></li>
<li><a href="FilesDB.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">database</div>
<h2 title="Class FilesDB" class="title">Class FilesDB</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>database.FilesDB</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">FilesDB</span>
extends java.lang.Object</pre>
<div class="block">Files Database.
 Abstract representation of files database. It's composed by one HashSet of
 OmniFile that saves files and by one HashMap that includes files being accessed
 at the moment and by who. The choice of a HashSet instead of a List is related
 to the functionality of HashSet in keeping unique objects, ensuring that we have
 not repeated files in the system.

 Created by OmniBox on 08/11/14.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../database/FilesDB.html#FilesDB()">FilesDB</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#addAccessToFile(shared.User,%20shared.OmniFile)">addAccessToFile</a></strong>(<a href="../shared/User.html" title="class in shared">User</a>&nbsp;user,
               <a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</code>
<div class="block">Adds access to file

 Marks a file as being accessed, and by which user</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#addFile(shared.OmniFile)">addFile</a></strong>(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</code>
<div class="block">Add File

 Add an OmniFile to the collection that stores all the existent files</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#customRemoveFile(shared.OmniFile)">customRemoveFile</a></strong>(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</code>
<div class="block">Because delete event on watcher is catch after file is deleted from disk, it screws over
 the references on fileList.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#fileExists(shared.OmniFile)">fileExists</a></strong>(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</code>
<div class="block">File Exists

 Checks if the file's collection contains the given OmniFile</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.ArrayList</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#fileList()">fileList</a></strong>()</code>
<div class="block">File List</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.HashSet&lt;<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#getFiles()">getFiles</a></strong>()</code>
<div class="block">Get Files</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#getNumberOfFiles()">getNumberOfFiles</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#getNumberOfFilesBeingAccessed()">getNumberOfFilesBeingAccessed</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#isFileBeingAccessed(shared.OmniFile)">isFileBeingAccessed</a></strong>(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</code>
<div class="block">File being accessed

 Checks if a file is being accessed by an user</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#rebuildFileSet(shared.OmniRepository)">rebuildFileSet</a></strong>(<a href="../shared/OmniRepository.html" title="class in shared">OmniRepository</a>&nbsp;omniRepository)</code>
<div class="block">Rebuid file's collection

 Given an OmniRepository, the file's collection is updated if the repository
 contains one (or more) file that does not exist inside file's collection</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#removeAccessToFile(shared.User)">removeAccessToFile</a></strong>(<a href="../shared/User.html" title="class in shared">User</a>&nbsp;user)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#removeFile(shared.OmniFile)">removeFile</a></strong>(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#removeFilesWithNoSource(database.RepositoriesDB)">removeFilesWithNoSource</a></strong>(<a href="../database/RepositoriesDB.html" title="class in database">RepositoriesDB</a>&nbsp;repositoriesDB)</code>
<div class="block">Remove File With No Source

 A file should be hosted by one repository, at least.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../database/FilesDB.html#setFiles(java.util.HashSet)">setFiles</a></strong>(java.util.HashSet&lt;<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&gt;&nbsp;files)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="FilesDB()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>FilesDB</h4>
<pre>public&nbsp;FilesDB()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="addFile(shared.OmniFile)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addFile</h4>
<pre>public&nbsp;void&nbsp;addFile(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</pre>
<div class="block">Add File

 Add an OmniFile to the collection that stores all the existent files</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>omniFile</code> - </dd></dl>
</li>
</ul>
<a name="fileExists(shared.OmniFile)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fileExists</h4>
<pre>public&nbsp;boolean&nbsp;fileExists(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</pre>
<div class="block">File Exists

 Checks if the file's collection contains the given OmniFile</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>omniFile</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the OmniFile exists, or false if don't</dd></dl>
</li>
</ul>
<a name="removeFilesWithNoSource(database.RepositoriesDB)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeFilesWithNoSource</h4>
<pre>public&nbsp;void&nbsp;removeFilesWithNoSource(<a href="../database/RepositoriesDB.html" title="class in database">RepositoriesDB</a>&nbsp;repositoriesDB)</pre>
<div class="block">Remove File With No Source

 A file should be hosted by one repository, at least. Otherwise,
 it will be removed from the file's collection</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>repositoriesDB</code> - </dd></dl>
</li>
</ul>
<a name="getNumberOfFiles()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNumberOfFiles</h4>
<pre>public&nbsp;int&nbsp;getNumberOfFiles()</pre>
</li>
</ul>
<a name="getNumberOfFilesBeingAccessed()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNumberOfFilesBeingAccessed</h4>
<pre>public&nbsp;int&nbsp;getNumberOfFilesBeingAccessed()</pre>
</li>
</ul>
<a name="removeFile(shared.OmniFile)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeFile</h4>
<pre>public&nbsp;boolean&nbsp;removeFile(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</pre>
</li>
</ul>
<a name="isFileBeingAccessed(shared.OmniFile)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isFileBeingAccessed</h4>
<pre>public&nbsp;boolean&nbsp;isFileBeingAccessed(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</pre>
<div class="block">File being accessed

 Checks if a file is being accessed by an user</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>omniFile</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the file is being accessed, false if don't</dd></dl>
</li>
</ul>
<a name="fileList()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fileList</h4>
<pre>public&nbsp;java.util.ArrayList&nbsp;fileList()</pre>
<div class="block">File List</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a list of the existent files</dd></dl>
</li>
</ul>
<a name="getFiles()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFiles</h4>
<pre>public&nbsp;java.util.HashSet&lt;<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&gt;&nbsp;getFiles()</pre>
<div class="block">Get Files</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the file's collection</dd></dl>
</li>
</ul>
<a name="rebuildFileSet(shared.OmniRepository)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rebuildFileSet</h4>
<pre>public&nbsp;void&nbsp;rebuildFileSet(<a href="../shared/OmniRepository.html" title="class in shared">OmniRepository</a>&nbsp;omniRepository)</pre>
<div class="block">Rebuid file's collection

 Given an OmniRepository, the file's collection is updated if the repository
 contains one (or more) file that does not exist inside file's collection</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>omniRepository</code> - </dd></dl>
</li>
</ul>
<a name="addAccessToFile(shared.User, shared.OmniFile)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addAccessToFile</h4>
<pre>public&nbsp;void&nbsp;addAccessToFile(<a href="../shared/User.html" title="class in shared">User</a>&nbsp;user,
                   <a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</pre>
<div class="block">Adds access to file

 Marks a file as being accessed, and by which user</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>user</code> - </dd><dd><code>omniFile</code> - </dd></dl>
</li>
</ul>
<a name="removeAccessToFile(shared.User)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeAccessToFile</h4>
<pre>public&nbsp;void&nbsp;removeAccessToFile(<a href="../shared/User.html" title="class in shared">User</a>&nbsp;user)</pre>
</li>
</ul>
<a name="setFiles(java.util.HashSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setFiles</h4>
<pre>public&nbsp;void&nbsp;setFiles(java.util.HashSet&lt;<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&gt;&nbsp;files)</pre>
</li>
</ul>
<a name="customRemoveFile(shared.OmniFile)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>customRemoveFile</h4>
<pre>public&nbsp;boolean&nbsp;customRemoveFile(<a href="../shared/OmniFile.html" title="class in shared">OmniFile</a>&nbsp;omniFile)</pre>
<div class="block">Because delete event on watcher is catch after file is deleted from disk, it screws over
 the references on fileList. LastMod is created specific for this situations.
 We have to redo the fileList but not using the usual equals and hash code from OmniFile.

 <U>Note that</U> OmniFile/File lastModified saves milliseconds from epoch January first 1970
 til the day it was modified.

 <U><H2>Important</H2></U>
 LastMod from omniFile received, from repository, has the lastModified milliseconds from when the
 file was deleted from the repository. So if size is equal and value of lastModified of aux
 is inferior to the one on omniFile then we'll assume its the same file we're trying to delete.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>omniFile</code> - file to be excluded from file list</dd>
<dt><span class="strong">Returns:</span></dt><dd>flag true if file was removed, false otherwise</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../database/RepositoriesDB.html" title="class in database"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?database/FilesDB.html" target="_top">Frames</a></li>
<li><a href="FilesDB.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
